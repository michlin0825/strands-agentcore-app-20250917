<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cognito Token Verification Demo</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 1200px; margin: 0 auto; padding: 20px; background: #f5f5f5; }
        .container { background: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .step { margin: 20px 0; padding: 20px; border-left: 4px solid #007dbc; background: #f8f9fa; }
        .step h3 { margin-top: 0; color: #007dbc; }
        .token-box { background: #e9ecef; padding: 15px; border-radius: 5px; font-family: monospace; font-size: 12px; word-break: break-all; }
        .success { color: #28a745; }
        .info { color: #17a2b8; }
        .warning { color: #ffc107; }
        .flow-diagram { text-align: center; margin: 20px 0; }
        .flow-step { display: inline-block; padding: 10px 20px; margin: 5px; background: #007dbc; color: white; border-radius: 5px; }
        .arrow { display: inline-block; margin: 0 10px; font-size: 20px; }
        .demo-results { background: #d4edda; padding: 15px; border-radius: 5px; margin: 10px 0; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ” Cognito Token Verification with AgentCore</h1>
        <p><strong>Live Demo Results from:</strong> <span class="info">2025-09-18 09:55:10 UTC</span></p>
        
        <div class="flow-diagram">
            <div class="flow-step">ğŸ‘¤ User Login</div>
            <span class="arrow">â†’</span>
            <div class="flow-step">ğŸ” Cognito Auth</div>
            <span class="arrow">â†’</span>
            <div class="flow-step">ğŸ« JWT Tokens</div>
            <span class="arrow">â†’</span>
            <div class="flow-step">ğŸ¤– AgentCore</div>
            <span class="arrow">â†’</span>
            <div class="flow-step">ğŸ’¬ AI Response</div>
        </div>

        <div class="step">
            <h3>ğŸ“ Step 1: Cognito Authentication</h3>
            <p><strong class="success">âœ… Authentication Successful</strong></p>
            <ul>
                <li><strong>User Pool:</strong> <code>us-east-1_LyhSJXjeF</code></li>
                <li><strong>Client ID:</strong> <code>2kiuoifa3ulekjbtdj4tngkt7h</code></li>
                <li><strong>Username:</strong> <code>michael_tw_lin@msn.com</code></li>
                <li><strong>Auth Flow:</strong> <code>ADMIN_NO_SRP_AUTH</code></li>
            </ul>
        </div>

        <div class="step">
            <h3>ğŸ“ Step 2: JWT Token Analysis</h3>
            
            <h4>ğŸ« Access Token (1 hour validity)</h4>
            <div class="token-box">
                <strong>Token:</strong> eyJraWQiOiJydlNFQzVaTjFLSkU2R0QyRWt6YlI5V0Nhb0lQSF...AqBeNp0mZw<br>
                <strong>Issued:</strong> 2025-09-18 01:55:10 UTC<br>
                <strong>Expires:</strong> 2025-09-18 02:55:10 UTC<br>
                <strong>Purpose:</strong> API Authorization<br>
                <strong>Client ID:</strong> 2kiuoifa3ulekjbtdj4tngkt7h
            </div>

            <h4>ğŸ†” ID Token (1 hour validity)</h4>
            <div class="token-box">
                <strong>Token:</strong> eyJraWQiOiJcL1FyNWRiN0FoSkp1blhsKzYrQk1raXdveEZYQi...meo07E-3NQ<br>
                <strong>Issued:</strong> 2025-09-18 01:55:10 UTC<br>
                <strong>Expires:</strong> 2025-09-18 02:55:10 UTC<br>
                <strong>Email:</strong> michael_tw_lin@msn.com<br>
                <strong>User ID:</strong> a4784418-c0a1-7047-69db-85e571bc97e3
            </div>

            <h4>ğŸ”„ Refresh Token (30 days validity)</h4>
            <div class="token-box">
                <strong>Token:</strong> eyJjdHkiOiJKV1QiLCJlbmMiOiJBMjU2R0NNIiwiYWxnIjoiUl...m6khyVmD9g<br>
                <strong>Purpose:</strong> Token renewal without re-authentication
            </div>
        </div>

        <div class="step">
            <h3>ğŸ“ Step 3: AgentCore Integration</h3>
            <p><strong class="success">âœ… Agent Successfully Processed Authenticated Request</strong></p>
            
            <h4>Request Details:</h4>
            <div class="token-box">
                <strong>Agent ARN:</strong> arn:aws:bedrock-agentcore:us-east-1:111735445051:runtime/HelloWorldStrandsAgent-EqFCwr3WrQ<br>
                <strong>Session ID:</strong> demo-a4784418-c0a1-7047-69db-85e571bc<br>
                <strong>User Context:</strong> michael_tw_lin@msn.com<br>
                <strong>Authentication:</strong> Verified via JWT tokens
            </div>

            <div class="demo-results">
                <h4>ğŸ¤– AI Agent Response:</h4>
                <p><em>"Hello Michael! I'm glad to meet you. As an AI assistant, I don't have any pre-existing information about specific users. However, I can confirm that you have identified yourself as michael_tw_lin@msn.com and that you are currently authenticated in our system..."</em></p>
            </div>
        </div>

        <div class="step">
            <h3>ğŸ“ Step 4: Security Features Demonstrated</h3>
            <ul>
                <li><strong class="success">ğŸ”’ JWT Signature Verification:</strong> Tokens cryptographically verified</li>
                <li><strong class="success">â±ï¸ Token Expiration:</strong> 1-hour access/ID token lifecycle</li>
                <li><strong class="success">ğŸ‘¤ User Identity Propagation:</strong> Email and User ID passed to agent</li>
                <li><strong class="success">ğŸ”„ Token Refresh:</strong> 30-day refresh token for seamless renewal</li>
                <li><strong class="success">ğŸ“Š Session Tracking:</strong> Conversation context maintained per user</li>
            </ul>
        </div>

        <div class="step">
            <h3>ğŸ“ Step 5: Token Lifecycle Management</h3>
            <div class="flow-diagram">
                <div style="background: #28a745;" class="flow-step">Login</div>
                <span class="arrow">â†’</span>
                <div style="background: #17a2b8;" class="flow-step">Use Tokens (1hr)</div>
                <span class="arrow">â†’</span>
                <div style="background: #ffc107; color: black;" class="flow-step">Token Expires</div>
                <span class="arrow">â†’</span>
                <div style="background: #6f42c1;" class="flow-step">Auto Refresh</div>
                <span class="arrow">â†’</span>
                <div style="background: #28a745;" class="flow-step">Continue</div>
            </div>
            
            <div class="token-box">
                <strong>Refresh Example:</strong><br>
                refresh_response = cognito_client.initiate_auth(<br>
                &nbsp;&nbsp;&nbsp;&nbsp;AuthFlow='REFRESH_TOKEN_AUTH',<br>
                &nbsp;&nbsp;&nbsp;&nbsp;AuthParameters={'REFRESH_TOKEN': refresh_token}<br>
                )
            </div>
        </div>

        <div class="demo-results">
            <h3>ğŸ‰ Demo Summary</h3>
            <p><strong>Successfully demonstrated complete Cognito token verification flow:</strong></p>
            <ul>
                <li>âœ… User authentication with email/password</li>
                <li>âœ… JWT token generation and parsing</li>
                <li>âœ… Token-based AgentCore API calls</li>
                <li>âœ… Personalized AI responses with user context</li>
                <li>âœ… Token lifecycle and refresh mechanisms</li>
            </ul>
        </div>
    </div>
</body>
</html>
